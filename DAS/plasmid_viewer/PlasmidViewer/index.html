<!DOCTYPE html>
<html lang="en" ng-app="myApp">
<head>
<script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>

<div ng-controller="LoadPlasmids">

    <!--</Assembly Viewer Plasmid>-->
    <plasmid sequencelength="{{plasmid.length}}" plasmidwidth="1200"
             plasmidheight="1200">

        <style>
            @import url("http://fonts.googleapis.com/css?family=Lato:300,400,700|Donegal+One|Source+Code+Pro:400");

            body {
                font-family: 'Lato';
                font-weight: 400;
            }

            .boundary {
                stroke-dasharray: 2, 2;
                stroke-width: 2px
            }

            .mdlabel {
                font-size: 12px
            }

            .smlabel {
                font-size: 8px
            }

            .white {
                fill: #fff
            }

            .red {
                fill: rgb(192, 64, 64)
            }

            .purple {
                fill: rgba(192, 64, 192, 0.5)
            }

            .blue {
                fill: rgb(64, 192, 192)
            }

            .trblue {
                fill: rgba(64, 192, 192, 0.5)
            }

            .green {
                fill: rgb(64, 192, 64)
            }

            .gold {
                fill: rgba(192, 128, 64, 0.2)
            }

            .marker {
                fill: rgba(0, 0, 0, 0.4)
            }

            .markerlite {
                fill: rgba(0, 0, 0, 0.0)
            }

            .labelline {
                stroke: #333;
                stroke-dasharray: 2, 2;
                stroke-width: 1px;
            }
        </style>
        <plasmidtrack trackstyle="fill:#ccc" width="5" radius="{{plasmid_size}}"></plasmidtrack>

        <!--Plasmid Map-->
        <plasmidtrack trackstyle="fill:rgba(225,225,225,0.5)" radius="{{plasmid_size}}" width="{{feature_width}}">
            <tracklabel labelstyle="font-size:18px;font-weight:700" text="{{plasmid.name}}" vadjust='{{-plasmid_size * 1.5}}'></tracklabel>
            <tracklabel labelstyle="font-size:10px;font-weight:300" vadjust='{{-plasmid_size * 1.5+20}}'
                        text="{{plasmid.length}} bp"></tracklabel>


            <!--Plasmid Features-->
            <trackmarker ng-repeat="feature in plasmid.features"
                         start="{{feature.plasmid_start}}" end="{{feature.plasmid_end}}"
                         markerstyle="fill:{{feature.qualifiers.ApEinfo_fwdcolor[0]}}"
                         vadjust="{{(feature.shell*(feature_width + feature_padding))}}"
                         wadjust="0"
                         arrowendlength="0"
                         arrowendwidth="0">
                feature label
                <markerlabel type="path" class="smlabel black" text="{{feature.name}}"></markerlabel>
                <!--<trackmarker start="{{feature._Region__start}}" end="{{feature.stop}}" markerstyle="fill:rgba(255,221,238,0.6)" wadjust="-5" vadjust="25"></trackmarker>-->
                <!--<trackmarker start="{{feature._Region__start}}" markerstyle="stroke:rgba(128,64,64,0.8)" class="boundary" wadjust="20">-->
                <!--<markerlabel class="smlabel red" text="{{feature._Region__start}}" vadjust="30"></markerlabel>-->
                <!--</trackmarker>-->
                <!--<trackmarker start="{{feature.stop}}" markerstyle="stroke:rgba(128,64,64,0.8)" class="boundary" wadjust="20">-->
                <!--<markerlabel class="smlabel red" text="{{feature.stop}}" vadjust="30"></markerlabel>-->
                <!--</trackmarker>-->

            </trackmarker>
            <trackscale interval="500" style="stroke:#f00" direction="in" showlabels="1"
                        labelstyle="fill:#999;stroke:none;text-anchor:middle;alignment-baseline:middle;font-size:10px"></trackscale>
        </plasmidtrack>

        <!--Contig Track-->
        <plasmidtrack radius="{{plasmid.size}}" class="markerlite" width="20">
            <!--&lt;!&ndash;Contigs&ndash;&gt;-->
            <!--<trackmarker ng-repeat="contig in contigs.contigs"-->
                         <!--start="{{contig.plasmid_start}}"-->
                         <!--end="{{contig.plasmid_end}}"-->
                         <!--valign="inner" wadjust="-15" vadjust="{{$index * 7 + contig_padding*contig.shell}}"-->
                         <!--class="{{ (contig.contig_type === 'product' ? 'purple' : 'gold' ) }}">-->

            <!--</trackmarker>-->

            <!--Primers-->
            <trackmarker ng-repeat="primer in primers.contigs"
                         start="{{(primer.query._Region__start > plasmid.length ? primer.query._Region__start - plasmid.length : primer.query._Region__start)}}"
                         end="{{(primer.query._Region__end > plasmid.length ? primer.query._Region__end - plasmid.length : primer.query._Region__end)}}"
                         markerstyle="stroke:rgba(255,0,0,0.5);stroke-width:0px" vadjust="0" wadjust="-9">
                <markerlabel text="{{primer.subject_acc}}" class="mdlabel red" valign="outer" vadjust="250"
                             showline="1" linevadjust="-5" lineclass="labelline"></markerlabel>
            </trackmarker>
        </plasmidtrack>

        <!--Inner Assembly Track-->
        <plasmidtrack radius="{{plasmid_size- 60}}" class="markerlite">
            <tracklabel labelstyle="font-size:18px;font-weight:700" text="${{assembly.cost.toFixed(2)}}" vadjust="-20"></tracklabel>
            <tracklabel labelstyle="font-size:10px;font-weight:300" vadjust="0" text="Assembly Probability: 75%"></tracklabel>
            <tracklabel labelstyle="font-size:10px;font-weight:300" vadjust="10" text="New Synth Cost: 1%"></tracklabel>
            <tracklabel labelstyle="font-size:10px;font-weight:300" vadjust="20" text="Primer Cost: 20%"></tracklabel>
            <tracklabel labelstyle="font-size:10px;font-weight:300" vadjust="30" text="PCR Cost: 20%"></tracklabel>
            <!--Primers-->

            <!--assembly-->
            <trackmarker
                    ng-repeat="contig in assembly.contigs"
                    start="{{(contig.query._Region__start > plasmid.length ? contig.query._Region__start - plasmid.length : contig.query._Region__start)}}"
                    end="{{(contig.query._Region__end > plasmid.length ? contig.query._Region__end - plasmid.length : contig.query._Region__end)}}"
                    markerstyle="fill:{{color()}}" wadjust="0" vadjust="0">
                <markerlabel type="path" class="smlabel white" text="{{contig.subject.name}}"></markerlabel>
                <!--region boundary-->
                <trackmarker
                        start="{{(contig.query._Region__start > plasmid.length ? contig.query._Region__start - plasmid.length : contig.query._Region__start)}}"
                        markerstyle="stroke:rgba(128,64,64,0.8)"
                        class="boundary"
                        wadjust="20"
                        valign="inner">
                    <markerlabel class="smlabel red"
                                 text="{{(contig.query._Region__start > plasmid.length ? contig.query._Region__start - plasmid.length : contig.query._Region__start)}}"
                                 vadjust="-10" valign="inner">

                    </markerlabel>
                </trackmarker>
                <trackmarker start="{{(contig.query._Region__end > plasmid.length ? contig.query._Region__end - plasmid.length : contig.query._Region__end)}}"
                             markerstyle="stroke:rgba(128,64,64,0.8)"
                             class="boundary"
                             wadjust="-0"
                             valign="inner">
                    <markerlabel
                            class="smlabel red"
                            text="{{(contig.query._Region__end > plasmid.length ? contig.query._Region__end - plasmid.length : contig.query._Region__end)}}"
                            vadjust="-25" valign="inner">

                    </markerlabel>
                </trackmarker>
            </trackmarker>


        </plasmidtrack>


    </plasmid>

</div>

<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
<script src="dist/angularplasmid.min.js"></script>
<script src="js/LoadPlasmidCoffee.js"></script>
</body>
</html>
<script src="js/PlasmidD3.js"></script>